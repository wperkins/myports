# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           cmake 1.0

name                cgnslib
version             3.2.1
set branch          [join [lrange [split ${version} .] 0 1] .]
set minor           [lindex [split ${version} .] end]

categories          science
platforms           darwin
maintainers         nomaintainer
license             zlib

description         Computational fluid dynamics data container.
long_description    \
    The CFD General Notation System (CGNS) provides a general, portable, \
    and extensible standard for the storage and retrieval of computational \
    fluid dynamics (CFD) analysis data. It consists of a collection of \
    conventions, and free and open software implementing those conventions. \
    It is self-descriptive, machine-independent, well-documented, and \
    administered by an international steering committee.

homepage            http://cgns.sourceforge.net/
master_sites        sourceforge:cgns
distname            ${name}_${branch}.${minor}
worksrcdir          ${name}_${branch}.${minor}

checksums           sha1    ac8e4d226da9397d79385c19a7cea82b4abc1983 \
                    rmd160  6542858178df461d831db9d2a38f6f97ca20be12

# HDF5 > 1.8 does not work with CGNS 3.2.1, use 1.8.x
# depends_lib         port:hdf5
depends_lib         port:hdf5-18

configure.args-append -D CGNS_BUILD_CGNSTOOLS:BOOL=OFF \
                      -D CGNS_BUILD_SHARED:BOOL=OFF \
                      -D CGNS_USE_SHARED:BOOL=OFF \
                      -D CGNS_ENABLE_LEGACY:BOOL=OFF \
                      -D CGNS_ENABLE_64BIT:BOOL=OFF \
                      -D CGNS_ENABLE_FORTRAN:BOOL=OFF \
                      -D CGNS_ENABLE_TESTS:BOOL=OFF \
                      -D CGNS_ENABLE_HDF5:BOOL=TRUE \
                      -D HDF5_INCLUDE_PATH:PATH="${prefix}/lib/hdf5-18/include" \
                      -D HDF5_LIBRARY:PATH="${prefix}/lib/hdf5-18/lib/libhdf5.a" \
                      -D HDF5_NEED_MPI:BOOL=FALSE \
                      -D HDF5_NEED_ZLIB:BOOL=TRUE \
                      -D HDF5_NEED_SZIP:BOOL=FALSE


# variant tools description { Build and install CGNS tools. } {
#     configure.args-delete "-D CGNS_BUILD_CGNSTOOLS:BOOL=OFF"
#     configrue.args-append "-D CGNS_BUILD_CGNSTOOLS:BOOL=ON"
# }

# variant fortran description { Build Fortran API. } {
#     configure.args-delete "-D CGNS_ENABLE_FORTRAN:BOOL=OFF"
#     configure.args-append "-D CGNS_ENABLE_FORTRAN:BOOL=ON"
# }


universal_variant   no
